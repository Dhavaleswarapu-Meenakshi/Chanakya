<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Stakeholder Requirement Validator</title>
<style>
:root{--bg:#0f1724;--card:#0b1220;--accent:#4f46e5;--muted:#94a3b8;--glass:rgba(255,255,255,0.03)}
*{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
body{margin:0;background:linear-gradient(180deg,#071129 0%,#081022 60%);color:#e6eef8;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:32px}
.wrap{width:100%;max-width:1100px}
h1{margin:0 0 10px;font-size:22px}
p.lead{margin:0;color:var(--muted)}
.grid{display:grid;grid-template-columns:1fr 420px;gap:20px;margin-top:20px}
.card{background:rgba(255,255,255,0.03);border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(2,6,23,0.6)}
textarea,input{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:var(--glass);color:inherit}
textarea{min-height:80px}
.btn{padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:600}
.btn-primary{background:linear-gradient(90deg,var(--accent),#7c3aed);color:white}
.small{font-size:12px;color:var(--muted)}
.valid{color:#22c55e;} .missing{color:#eab308;} .conflict{color:#ef4444;}
.align{font-size:12px;color:#94a3b8;margin-left:14px}
.noalign{font-size:12px;color:#ef4444;margin-left:14px}
pre{background:rgba(255,255,255,0.05);padding:10px;border-radius:8px;max-height:300px;overflow:auto;font-size:13px}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <h1>Stakeholder Requirement Validator</h1>
    <p class="lead">Enter requirement → answer clarifications → see results instantly (validation, contradictions, alignment)</p>
  </header>

  <div class="grid">
    <!-- Input & Questions -->
    <section class="card">
      <label>Stakeholder Requirement</label>
      <textarea id="requirement" placeholder="e.g. Food delivery app with fast delivery and ratings"></textarea>
      <button id="generate" class="btn btn-primary" style="margin-top:10px">Generate Questions</button>

      <div id="questionsWrap" style="margin-top:15px;display:none">
        <label class="small">Clarification Questions</label>
        <div id="questionsList"></div>
        <button id="process" class="btn btn-primary" style="margin-top:10px">Validate Requirement</button>
      </div>
    </section>

    <!-- Results -->
    <aside class="card">
      <strong>Results</strong>
      <label class="small">Structured Requirements</label>
      <pre id="reqOut"></pre>
      <label class="small">Contradictions</label>
      <pre id="conOut"></pre>
    </aside>
  </div>
</div>

<script>
// ===== Config =====
const CONTRADICTION_PAIRS = [
  ["Multiple languages support","English language support"],
  ["High security","User-friendly login"],
  ["Fast delivery","No delivery service"]
];

// ===== Example dataset =====
const DATASET = [
  {goal:"Deliver food under 30 minutes", compliance_issues:["Traffic delays"], regulations:["Delivery norms"]},
  {goal:"Multiple payment support", compliance_issues:["Fraud detection"], regulations:["PCI DSS"]},
  {goal:"Support multiple languages", compliance_issues:["Translation quality"], regulations:["Accessibility"]},
  {goal:"Secure login with 2FA", compliance_issues:["User friction"], regulations:["Data Protection Law"]},
  {goal:"Send notifications", compliance_issues:["Spam risk"], regulations:["Consumer Protection"]}
];

// ===== Helpers =====
function conciseValue(point, clarAns){
  const textAll = Object.values(clarAns).join(" ").toLowerCase();
  if(!textAll) return "⚠ Missing";

  if(point.includes("Fast delivery")){
    if(textAll.includes("30")) return "Under 30 minutes";
    if(textAll.includes("fast")) return "Fast";
  }
  if(point.includes("payment")) return /cash|upi|card|wallet/.test(textAll) ? "Cards, UPI, Wallets" : "⚠ Missing";
  if(point.includes("ratings")) return textAll.includes("yes") ? "Yes" : "⚠ Missing";
  if(point.includes("notifications")) return textAll.includes("yes") ? "Yes" : "⚠ Missing";
  if(point.includes("languages")) return textAll.match(/english|hindi|tamil/) ? "English, Regional" : "⚠ Missing";
  if(point.includes("security")) return textAll.includes("2fa") || textAll.includes("secure") ? "2FA, Secure Login" : "⚠ Missing";
  if(point.includes("login")) return textAll.includes("frictionless") ? "Frictionless" : "⚠ Missing";

  return "⚠ Missing";
}

function downloadFile(data, filename){
  const blob = new Blob([JSON.stringify(data,null,2)], {type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = filename;
  a.click();
}

// ===== UI logic =====
document.getElementById('generate').addEventListener('click', ()=>{
  const questions = [
    "Do you need fast delivery (under 30 minutes)?",
    "Do you need no delivery service at all?",
    "Should the app support multiple payment options?",
    "Do you want restaurant ratings and reviews?",
    "Should the app support multiple languages?",
    "Do you want order status notifications?",
    "Do you want high security (2FA, strict login)?",
    "Should login be frictionless?"
  ];
  const qList=document.getElementById('questionsList'); qList.innerHTML='';
  questions.forEach(q=>{
    const div=document.createElement('div');
    div.innerHTML=`<label class="small">${q}</label><input data-q="${q}" placeholder="Answer here">`;
    qList.appendChild(div);
  });
  document.getElementById('questionsWrap').style.display='block';
});

document.getElementById('process').addEventListener('click', ()=>{
  const clarAns={};
  document.querySelectorAll('#questionsList input').forEach(inp=>{
    if(inp.value.trim()) clarAns[inp.dataset.q]=inp.value.trim();
  });

  // Build structured requirements
  const requirements={};
  Object.keys(clarAns).forEach(q=>{
    requirements[q]=conciseValue(q, clarAns);
  });

  // Detect contradictions
  const contradictions=[];
  CONTRADICTION_PAIRS.forEach(([a,b])=>{
    if(requirements[a] && requirements[b]){
      contradictions.push({requirement_a:a, requirement_b:b, suggestion:"Conflict — choose one or clarify"});
    }
  });

  // Alignment
  const alignment={};
  Object.keys(requirements).forEach(req=>{
    const match=DATASET.find(item=>req.toLowerCase().includes(item.goal.split(" ")[0].toLowerCase()));
    alignment[req]=match||null;
  });

  // Show results
  const reqOut=document.getElementById('reqOut'); reqOut.innerHTML='';
  Object.entries(requirements).forEach(([req,val])=>{
    const line=document.createElement('div');
    line.className=val.includes("⚠")?"missing":"valid";
    line.textContent=`• ${req}: ${val}`;
    reqOut.appendChild(line);

    if(alignment[req]){
      const info=document.createElement('div');
      info.className="align";
      info.textContent=`→ Aligns with goal: ${alignment[req].goal}`;
      reqOut.appendChild(info);
    } else {
      const info=document.createElement('div');
      info.className="noalign";
      info.textContent="→ ❌ No matching dataset goal";
      reqOut.appendChild(info);
    }
  });

  const conOut=document.getElementById('conOut'); conOut.innerHTML='';
  if(contradictions.length){
    contradictions.forEach(c=>{
      const line=document.createElement('div');
      line.className="conflict";
      line.textContent=`⚠ Conflict: ${c.requirement_a} vs ${c.requirement_b}`;
      conOut.appendChild(line);
    });
  } else {
    conOut.innerHTML='<div class="valid">✅ No contradictions found</div>';
  }

  // Auto-download results
  downloadFile({requirements,contradictions,alignment},"results.json");
});
</script>
</body>
</html>
